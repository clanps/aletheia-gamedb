// SPDX-FileCopyrightText: 2025 Spencer
// SPDX-License-Identifier: AGPL-3.0-only

import { ThemeLogic } from "../logic/theme.slint";

export component SearchBar inherits Rectangle {
  in property <string> placeholder_text;
  out property <bool> has_focus: input.has-focus;
  out property <string> text: input.text;
  callback changed(string);

  background: ThemeLogic.colors.surface;
  clip: true;
  border-radius: 20px;
  border-width: 1px;
  border-color: root.has_focus ? ThemeLogic.colors.border_hover : ThemeLogic.colors.surface_border;
  drop-shadow-blur: 8px;
  drop-shadow-color: ThemeLogic.colors.surface_shadow;
  drop-shadow-offset-y: 4px;

  HorizontalLayout {
    spacing: 8px;
    padding-left: 12px;
    padding-right: 12px;

    Image {
      width: 24px;
      source: @image-url("../assets/search.svg");
      opacity: 75%;
    }

    input := TextInput {
      single-line: true;
      color: ThemeLogic.colors.text_primary;
      opacity: 65%;
      font-family: "Inter";
      font-size: 14px;
      font-weight: 400;
      vertical-alignment: center;
      accessible-label: root.placeholder_text;

      if (self.text.is-empty): Text {
        x: 0;
        text: root.placeholder_text;
        color: ThemeLogic.colors.search_bar_text;
        opacity: 50%;
        font-family: "Inter";
        font-size: 14px;
        font-weight: 400;
      }

      edited => root.changed(self.text);
    }
  }
}
